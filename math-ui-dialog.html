<style>
    dialog.math-ui {
        background-color: #d6e3e7;
        border: 1px solid white;
        padding: 0;
        font-family: sans-serif;
        font-size: 1rem;
    }
    dialog.math-ui > .header {
        background-color: #4f7dc9;
        color: #fff;
        height: 3em;
        line-height: 3em;
        padding: 0 1em;
        margin: 0;
    }
    dialog.math-ui > .content {
        color: #000;
        padding: 0;
        margin: 0;
    }
    dialog.math-ui > .content button {
        background-color: transparent;
        color: #333;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        border: none;
        outline: none;
        padding: 0.5em 1em;
        margin: 0;
        font-size: 1em;
        text-align: left;
        width: 100%;
        display: block;
    }
    dialog.math-ui > .content button:hover {
        background-color: #eaf1f3;
    }
    dialog.math-ui > .content button:focus {
        font-weight: bold;
    }
</style>

<template id="dialog-polyfill">
    <link rel="import" href="dialog-polyfill.html" />
</template>

<script>
(function () {
    'use strict';

    if (document.createElement('dialog') instanceof HTMLUnknownElement) {
        var importDoc = (document._currentScript ? document._currentScript : document.currentScript).ownerDocument;
        var head = document.querySelector('head');
        var tmpl = importDoc.querySelector('#dialog-polyfill');
        var node = document.importNode(tmpl.content, true);
        head.insertBefore(node, head.firstChild);
        console.log('loaded dialog polyfill');
    }

    var element = Object.create(HTMLElement.prototype);

    function isAncestorOf(ancestor, node) {
        while (node) {
            if (ancestor === node)
                return true;
            node = node.parentNode;
        }
        return false;
    }

    element.showModal = function (dialog, clickHandler, closeHandler) {
        document.body.appendChild(dialog);
        if (!dialog.showModal && window.dialogPolyfill) {
            dialogPolyfill.registerDialog(dialog);
        }
        dialog.showModal();
        function onDocumentClick(ev) {
            if (!clickHandler || !isAncestorOf(dialog, ev.target) || clickHandler(ev))
                dialog.close();
        }
        function onClose() {
            dialog.removeEventListener('close', onClose);
            document.removeEventListener('click', onDocumentClick);
            if (closeHandler) closeHandler();
            document.body.removeChild(dialog);
        }
        dialog.addEventListener('close', onClose);
        document.addEventListener('click', onDocumentClick);
        return dialog;
    };

    document.registerElement('math-ui-dialog', {prototype: element});

})();
</script>
